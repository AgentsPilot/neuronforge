{
  "plugin": {
    "name": "google-drive",
    "version": "1.0.0",
    "description": "Access, search, and read files and folders in Google Drive",
    "context": "Use for accessing Google Drive files, searching documents, reading file contents, and browsing folder structures",
    "icon": "<Calendar className='w-5 h-5 text-blue-600'/>",
    "category": "productivity",
    "isPopular": true,
    "auth_config": {
      "auth_type": "oauth2_google",
      "client_id": "${GOOGLE_CLIENT_ID}",
      "client_secret": "${GOOGLE_CLIENT_SECRET}",
      "redirect_uri": "${NEXT_PUBLIC_APP_URL}/oauth/callback/google-drive",
      "auth_url": "https://accounts.google.com/o/oauth2/v2/auth",
      "token_url": "https://oauth2.googleapis.com/token",
      "refresh_url": "https://oauth2.googleapis.com/token",
      "profile_url": "https://www.googleapis.com/oauth2/v2/userinfo",
      "required_scopes": [
        "openid",
        "email",
        "profile",
        "https://www.googleapis.com/auth/drive.readonly",
        "https://www.googleapis.com/auth/drive.metadata.readonly",
        "https://www.googleapis.com/auth/drive.file"
      ]
    }
  },
  "actions": {
    "list_files": {
      "description": "List files and folders in Google Drive with optional filtering",
      "usage_context": "When user wants to browse their Drive contents, see files in a folder, or list files matching criteria",
      "parameters": {
        "type": "object",
        "properties": {
          "folder_id": {
            "type": "string",
            "description": "ID of the folder to list files from. If not provided, lists from root or recent files",
            "x-dynamic-options": {
              "source": "list_folders",
              "description": "Fetches available folders dynamically"
            }
          },
          "max_results": {
            "type": "number",
            "minimum": 1,
            "maximum": 100,
            "default": 20,
            "description": "Maximum number of files to return"
          },
          "order_by": {
            "type": "string",
            "enum": ["modifiedTime", "name", "createdTime", "folder", "starred"],
            "default": "modifiedTime",
            "description": "How to order the file results"
          },
          "file_types": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["document", "spreadsheet", "presentation", "pdf", "image", "video", "folder", "all"]
            },
            "description": "Filter by specific file types"
          },
          "include_trashed": {
            "type": "boolean",
            "default": false,
            "description": "Include files in trash"
          }
        }
      },
      "rules": {
        "limits": {
          "max_results": {
            "condition": "max_results > 100",
            "action": "block",
            "message": "Cannot retrieve more than 100 files at once. Please reduce max_results."
          }
        },
        "confirmations": {
          "large_list": {
            "condition": "max_results > 50",
            "action": "confirm",
            "message": "List {max_results} files? This may take longer to process."
          }
        }
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "files": {
            "type": "array",
            "description": "List of files and folders",
            "items": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "description": "Unique file ID" },
                "name": { "type": "string", "description": "File or folder name" },
                "mimeType": { "type": "string", "description": "MIME type of the file" },
                "size": { "type": "string", "description": "File size in bytes" },
                "createdTime": { "type": "string", "description": "Creation timestamp (ISO 8601)" },
                "modifiedTime": { "type": "string", "description": "Last modification timestamp (ISO 8601)" },
                "webViewLink": { "type": "string", "description": "URL to view the file" },
                "shared": { "type": "boolean", "description": "Whether file is shared" },
                "starred": { "type": "boolean", "description": "Whether file is starred" }
              }
            }
          },
          "file_count": { "type": "integer", "description": "Number of files returned" },
          "next_page_token": { "type": "string", "description": "Token for fetching next page of results" },
          "has_more": { "type": "boolean", "description": "Whether more files are available" },
          "query_used": { "type": "string", "description": "The query used to filter results" },
          "retrieved_at": { "type": "string", "description": "Timestamp when data was retrieved (ISO 8601)" }
        }
      },
      "output_guidance": {
        "success_description": "Returns a list of files and folders with metadata including size, dates, and sharing status.",
        "sample_output": {
          "files": [
            {
              "id": "1abc123xyz",
              "name": "Project Report.docx",
              "mimeType": "application/vnd.google-apps.document",
              "size": "15360",
              "createdTime": "2024-01-10T09:00:00Z",
              "modifiedTime": "2024-01-14T15:30:00Z",
              "webViewLink": "https://docs.google.com/document/d/1abc123xyz",
              "shared": true,
              "starred": false
            }
          ],
          "file_count": 1,
          "has_more": false,
          "query_used": "trashed = false",
          "retrieved_at": "2024-01-15T10:00:00Z"
        },
        "common_errors": {
          "auth_failed": "Your Google Drive connection has expired. Please go to Settings → Connected Apps to reconnect Google Drive.",
          "folder_not_found": "The specified folder was not found. Please check the folder ID and try again.",
          "permission_denied": "You don't have permission to access this folder. Please request access from the owner.",
          "api_rate_limit": "Too many requests in a short time. Please wait a moment and try again.",
          "insufficient_permissions": "Google Drive permissions are insufficient. Please reconnect with full read access."
        }
      }
    },
    "search_files": {
      "description": "Search for files and folders using Google Drive's query syntax",
      "usage_context": "When user wants to find specific files by name, content, type, or other criteria",
      "parameters": {
        "type": "object",
        "required": ["query"],
        "properties": {
          "query": {
            "type": "string",
            "description": "Search query (supports Drive operators like 'name contains', 'mimeType =', 'fullText contains', etc.)"
          },
          "max_results": {
            "type": "number",
            "minimum": 1,
            "maximum": 100,
            "default": 20,
            "description": "Maximum number of files to return"
          },
          "search_scope": {
            "type": "string",
            "enum": ["all", "owned_by_me", "shared_with_me", "starred"],
            "default": "all",
            "description": "Scope of the search"
          },
          "file_types": {
            "type": "array",
            "items": {
              "type": "string",
              "enum": ["document", "spreadsheet", "presentation", "pdf", "image", "video", "folder"]
            },
            "description": "Filter search by specific file types"
          }
        }
      },
      "rules": {
        "limits": {
          "max_results": {
            "condition": "max_results > 100",
            "action": "block",
            "message": "Cannot search for more than 100 files at once."
          }
        },
        "confirmations": {
          "large_search": {
            "condition": "max_results > 50",
            "action": "confirm",
            "message": "Search for {max_results} files? This may take longer to process."
          }
        }
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "files": {
            "type": "array",
            "description": "List of matching files and folders",
            "items": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "description": "Unique file ID" },
                "name": { "type": "string", "description": "File or folder name" },
                "mimeType": { "type": "string", "description": "MIME type of the file" },
                "size": { "type": "string", "description": "File size in bytes" },
                "createdTime": { "type": "string", "description": "Creation timestamp (ISO 8601)" },
                "modifiedTime": { "type": "string", "description": "Last modification timestamp (ISO 8601)" },
                "webViewLink": { "type": "string", "description": "URL to view the file" },
                "shared": { "type": "boolean", "description": "Whether file is shared" },
                "starred": { "type": "boolean", "description": "Whether file is starred" }
              }
            }
          },
          "file_count": { "type": "integer", "description": "Number of files found" },
          "search_query": { "type": "string", "description": "The search query that was executed" },
          "next_page_token": { "type": "string", "description": "Token for fetching next page of results" },
          "has_more": { "type": "boolean", "description": "Whether more results are available" },
          "searched_at": { "type": "string", "description": "Timestamp when search was performed (ISO 8601)" },
          "message": { "type": "string", "description": "Status message if no results found" }
        }
      },
      "output_guidance": {
        "success_description": "Returns files matching the search query with metadata and pagination info.",
        "sample_output": {
          "files": [
            {
              "id": "1xyz789abc",
              "name": "Q4 Budget.xlsx",
              "mimeType": "application/vnd.google-apps.spreadsheet",
              "size": "24576",
              "modifiedTime": "2024-01-13T11:00:00Z",
              "webViewLink": "https://docs.google.com/spreadsheets/d/1xyz789abc",
              "shared": false,
              "starred": true
            }
          ],
          "file_count": 1,
          "search_query": "(fullText contains 'budget') and trashed = false",
          "has_more": false,
          "searched_at": "2024-01-15T10:30:00Z"
        },
        "common_errors": {
          "auth_failed": "Your Google Drive connection has expired. Please reconnect in Settings → Connected Apps.",
          "invalid_query": "The search query format is invalid. Please check your search terms and try again.",
          "no_results": "No files found matching your search criteria. Try different keywords or broader search terms.",
          "api_rate_limit": "Too many search requests. Please wait a moment and try again.",
          "insufficient_permissions": "Google Drive read permissions are insufficient. Please reconnect with full access."
        }
      }
    },
    "get_file_metadata": {
      "description": "Get detailed information about a specific file or folder",
      "usage_context": "When user wants to see properties, permissions, or details about a specific file",
      "parameters": {
        "type": "object",
        "required": ["file_id"],
        "properties": {
          "file_id": {
            "type": "string",
            "description": "The ID of the file or folder",
            "x-dynamic-options": {
              "source": "list_files",
              "description": "Fetches available files dynamically"
            }
          },
          "include_permissions": {
            "type": "boolean",
            "default": false,
            "description": "Include sharing permissions information"
          },
          "include_export_links": {
            "type": "boolean",
            "default": false,
            "description": "Include export links for Google Workspace files"
          }
        }
      },
      "rules": {
        "limits": {},
        "confirmations": {}
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "file": { "type": "object", "description": "Complete file metadata from Google Drive API" },
          "file_id": { "type": "string", "description": "Unique file identifier" },
          "file_name": { "type": "string", "description": "Name of the file or folder" },
          "file_type": { "type": "string", "description": "Friendly file type (document, spreadsheet, folder, etc.)" },
          "mime_type": { "type": "string", "description": "MIME type of the file" },
          "size_bytes": { "type": "integer", "description": "File size in bytes" },
          "created_at": { "type": "string", "description": "Creation timestamp (ISO 8601)" },
          "modified_at": { "type": "string", "description": "Last modification timestamp (ISO 8601)" },
          "owner": { "type": "string", "description": "File owner name or email" },
          "web_view_link": { "type": "string", "description": "URL to view the file in browser" },
          "is_folder": { "type": "boolean", "description": "Whether this is a folder" },
          "retrieved_at": { "type": "string", "description": "Timestamp when metadata was retrieved (ISO 8601)" }
        }
      },
      "output_guidance": {
        "success_description": "Returns comprehensive file metadata including ownership, size, and access links.",
        "sample_output": {
          "file_id": "1abc123xyz",
          "file_name": "Annual Report 2024.docx",
          "file_type": "document",
          "mime_type": "application/vnd.google-apps.document",
          "size_bytes": 52428,
          "created_at": "2024-01-05T08:00:00Z",
          "modified_at": "2024-01-14T16:45:00Z",
          "owner": "jane.doe@company.com",
          "web_view_link": "https://docs.google.com/document/d/1abc123xyz",
          "is_folder": false,
          "retrieved_at": "2024-01-15T11:00:00Z"
        },
        "common_errors": {
          "auth_failed": "Your Google Drive connection has expired. Please reconnect in Settings → Connected Apps.",
          "file_not_found": "The specified file was not found. It may have been deleted or you don't have access.",
          "permission_denied": "You don't have permission to access this file. Please request access from the owner.",
          "api_rate_limit": "Too many requests. Please wait a moment and try again.",
          "insufficient_permissions": "Google Drive permissions are insufficient. Please reconnect with metadata read access."
        }
      }
    },
    "read_file_content": {
      "description": "Read and extract text content from a file",
      "usage_context": "When user wants to read the contents of a document, view text from files, or extract information",
      "parameters": {
        "type": "object",
        "required": ["file_id"],
        "properties": {
          "file_id": {
            "type": "string",
            "description": "The ID of the file to read",
            "x-dynamic-options": {
              "source": "list_files",
              "description": "Fetches available files dynamically"
            }
          },
          "export_format": {
            "type": "string",
            "enum": ["text/plain", "text/html", "application/pdf"],
            "default": "text/plain",
            "description": "Format to export Google Workspace files (Docs, Sheets, Slides)"
          },
          "max_size_mb": {
            "type": "number",
            "minimum": 1,
            "maximum": 10,
            "default": 5,
            "description": "Maximum file size to read in megabytes"
          }
        }
      },
      "rules": {
        "limits": {
          "file_size": {
            "condition": "max_size_mb > 10",
            "action": "block",
            "message": "Cannot read files larger than 10MB. Please reduce the file size or download separately."
          }
        },
        "confirmations": {
          "large_file": {
            "condition": "max_size_mb > 5",
            "action": "confirm",
            "message": "Read file up to {max_size_mb}MB? Large files may take time to process."
          }
        }
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "file_id": { "type": "string", "description": "ID of the file that was read" },
          "file_name": { "type": "string", "description": "Name of the file" },
          "file_size": { "type": "string", "description": "Human-readable file size (e.g., '1.5 MB')" },
          "mime_type": { "type": "string", "description": "MIME type of the file" },
          "content": { "type": "string", "description": "Text content extracted from the file" },
          "content_length": { "type": "integer", "description": "Length of the extracted content in characters" },
          "export_format": { "type": "string", "description": "Format the file was exported as (text/plain, text/html, or 'original')" },
          "read_at": { "type": "string", "description": "Timestamp when file was read (ISO 8601)" }
        }
      },
      "output_guidance": {
        "success_description": "Returns the text content of the file along with metadata about size and format.",
        "sample_output": {
          "file_id": "1abc123xyz",
          "file_name": "Meeting Notes.docx",
          "file_size": "2.34 KB",
          "mime_type": "application/vnd.google-apps.document",
          "content": "Meeting Notes - January 15, 2024\n\nAttendees: John, Jane, Bob\n\nAgenda:\n1. Q4 Review...",
          "content_length": 1523,
          "export_format": "text/plain",
          "read_at": "2024-01-15T11:30:00Z"
        },
        "common_errors": {
          "auth_failed": "Your Google Drive connection has expired. Please reconnect in Settings → Connected Apps.",
          "file_not_found": "The specified file was not found or you don't have access.",
          "file_too_large": "The file is too large to read. Maximum size is 10MB. Please try a smaller file.",
          "unsupported_format": "This file format cannot be read as text. Supported formats: Google Docs, plain text, PDFs, and more.",
          "export_failed": "Failed to export Google Workspace file. The file may be corrupted or in an unsupported format.",
          "api_rate_limit": "Too many requests. Please wait a moment and try again.",
          "insufficient_permissions": "Google Drive read permissions are insufficient. Please reconnect with full read access."
        }
      }
    },
    "get_folder_contents": {
      "description": "Get all files and subfolders within a specific folder",
      "usage_context": "When user wants to explore a folder's contents, browse folder hierarchy, or organize files",
      "parameters": {
        "type": "object",
        "required": ["folder_id"],
        "properties": {
          "folder_id": {
            "type": "string",
            "description": "The ID of the folder to explore. Use 'root' for the root folder",
            "x-dynamic-options": {
              "source": "list_folders",
              "description": "Fetches available folders dynamically"
            }
          },
          "max_results": {
            "type": "number",
            "minimum": 1,
            "maximum": 100,
            "default": 50,
            "description": "Maximum number of items to return"
          },
          "recursive": {
            "type": "boolean",
            "default": false,
            "description": "Include files from subfolders recursively"
          },
          "order_by": {
            "type": "string",
            "enum": ["name", "modifiedTime", "createdTime", "folder"],
            "default": "name",
            "description": "How to order the results"
          }
        }
      },
      "rules": {
        "limits": {
          "max_results": {
            "condition": "max_results > 100",
            "action": "block",
            "message": "Cannot retrieve more than 100 items at once."
          }
        },
        "confirmations": {
          "recursive_search": {
            "condition": "recursive == true",
            "action": "confirm",
            "message": "Recursively search all subfolders? This may take significant time for large folder structures."
          }
        }
      },
      "output_schema": {
        "type": "object",
        "properties": {
          "folder_id": { "type": "string", "description": "ID of the folder that was explored" },
          "folder_name": { "type": "string", "description": "Name of the folder" },
          "items": {
            "type": "array",
            "description": "All items (files and folders) in the folder",
            "items": {
              "type": "object",
              "properties": {
                "id": { "type": "string", "description": "Unique item ID" },
                "name": { "type": "string", "description": "Item name" },
                "mimeType": { "type": "string", "description": "MIME type" },
                "size": { "type": "string", "description": "Size in bytes (files only)" },
                "modifiedTime": { "type": "string", "description": "Last modification timestamp" },
                "webViewLink": { "type": "string", "description": "URL to view the item" }
              }
            }
          },
          "item_count": { "type": "integer", "description": "Total number of items" },
          "folder_count": { "type": "integer", "description": "Number of subfolders" },
          "file_count": { "type": "integer", "description": "Number of files" },
          "folders": { "type": "array", "description": "List of subfolders only" },
          "files": { "type": "array", "description": "List of files only" },
          "next_page_token": { "type": "string", "description": "Token for fetching next page of results" },
          "has_more": { "type": "boolean", "description": "Whether more items are available" },
          "retrieved_at": { "type": "string", "description": "Timestamp when data was retrieved (ISO 8601)" }
        }
      },
      "output_guidance": {
        "success_description": "Returns folder contents separated into files and subfolders with counts and pagination.",
        "sample_output": {
          "folder_id": "1folder789xyz",
          "folder_name": "Projects",
          "items": [
            {"id": "1abc", "name": "Project A", "mimeType": "application/vnd.google-apps.folder"},
            {"id": "2def", "name": "Report.docx", "mimeType": "application/vnd.google-apps.document", "size": "10240"}
          ],
          "item_count": 2,
          "folder_count": 1,
          "file_count": 1,
          "folders": [{"id": "1abc", "name": "Project A", "mimeType": "application/vnd.google-apps.folder"}],
          "files": [{"id": "2def", "name": "Report.docx", "mimeType": "application/vnd.google-apps.document", "size": "10240"}],
          "has_more": false,
          "retrieved_at": "2024-01-15T12:00:00Z"
        },
        "common_errors": {
          "auth_failed": "Your Google Drive connection has expired. Please reconnect in Settings → Connected Apps.",
          "folder_not_found": "The specified folder was not found. Please check the folder ID and try again.",
          "permission_denied": "You don't have permission to access this folder. Please request access from the owner.",
          "not_a_folder": "The specified ID is not a folder. Please provide a valid folder ID.",
          "api_rate_limit": "Too many requests. Please wait a moment and try again.",
          "insufficient_permissions": "Google Drive permissions are insufficient. Please reconnect with folder read access."
        }
      }
    }
  }
}